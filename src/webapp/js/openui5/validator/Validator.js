sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/core/Control","sap/ui/core/ValueState","sap/ui/core/MessageType","sap/ui/core/message/Message","./thirdparty/ajv.min","./library"],function(t,e,r,o,s,i){"use strict";const a=["dateValue","selectedKey","selected","value"];const n={$data:true,allErrors:true,coerceTypes:true,errorDataPath:"property"};const l=e.extend("openui5.validator.Validator",{constructor:function(t,r,o){if(!t||!r){throw new Error("Missing parameters!")}e.apply(this,arguments);const s=new Ajv(o||n);this._validate=s.compile(r);this._view=t;this._errors=null;this._payload=null;this._validProperties=[];this.addValidProperties(a)}});l.prototype.destroy=function(){this._validate=null;this._view=null;this._errors=null;this._payload=null;this._validProperties=null};l.prototype.validate=function(){const t=this._getControls();this._payload=this._getPayloadToValidate(t);this._clearControlStatus(t);const e=this._validate(this._payload);if(e){this._errors=null}else{this._errors=this._processValidationErrors(this._validate.errors)}return e};l.prototype.getErrors=function(){return this._errors};l.prototype.getPayloadUsedInValidation=function(){return this._payload};l.prototype.getValidProperties=function(){return this._validProperties.map(function t(e){return e})};l.prototype.addValidProperties=function(t){const e=this;t.forEach(function t(r){e._validProperties.push(r)})};l.prototype._getControls=function(){const t=this;let e=[];if(this._validate.schema&&this._validate.schema.properties){e=Object.keys(this._validate.schema.properties).map(function e(o){const s=t._view.byId(o);return s instanceof r?s:null}).filter(function t(e){return e})}return e};l.prototype._getPayloadToValidate=function(t){const e=this;const r={};t.forEach(function t(o){const s=o.getId().lastIndexOf("-")+1;const i=o.getId().substring(s);r[i]=e._getControlValue(o)});return r};l.prototype._getControlValue=function(t){let e=null;const r=Object.keys(t.mProperties);this._validProperties.forEach(function o(s){if(!e){const o=r.find(function t(e){return e===s});if(o){const r=["get",s.substring(0,1).toUpperCase(),s.substring(1)].join("");if(t[r]){e=t[r]()}}}});return e};l.prototype._clearControlStatus=function(t){t.forEach(function t(e){if(e&&e.setValueState){e.setValueState(o.None)}if(e&&e.setValueStateText){e.setValueStateText()}})};l.prototype._setControlErrorStatus=function(t,e){if(t&&t.setValueState){t.setValueState(o.Error)}if(t&&t.setValueStateText){t.setValueStateText(e)}};l.prototype._processValidationErrors=function(t){const e=this;const r=[];t.forEach(function t(o){const s=o.dataPath.substring(1);const i=e._view.byId(s);if(i){e._setControlErrorStatus(i,o.message);r.push(e._createErrorMessageObject(i,o.message,""))}});return r};l.prototype._createErrorMessageObject=function(t,e,r){return new i({message:e,description:r,type:s.Error,target:[t.getId(),"/"].join("")})};return l},true);